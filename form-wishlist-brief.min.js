document.addEventListener("DOMContentLoaded",(function(){const e="wishlist",t=document.querySelector('[wl-page="list"]'),n=document.querySelector("#wishlist-card-template"),o=document.querySelector('[form-element="wishlist"]'),r=document.querySelector("#brief-pro-wishlist-category"),a=document.querySelector("#brief-pro-wishlist-product"),c=document.querySelector("#brief-private-wishlist-category"),i=document.querySelector("#brief-private-wishlist-product"),u=document.querySelector('[wl-page="counter-label"]'),l=document.querySelector('[wl="counter"]'),d=(navigator.language||navigator.userLanguage).startsWith("en");let s;try{s=JSON.parse(localStorage.getItem(e))||[]}catch(e){s=[]}function m(){localStorage.setItem(e,JSON.stringify(s)),function(){const e=new CustomEvent("wishlist:updated",{detail:{wishlist:s}});document.dispatchEvent(e)}()}function y(){document.querySelectorAll('[wl="counter"]').forEach((e=>{e.textContent=s.length})),function(){const e=s.length;if(l&&u){const t=d?1===e?"product added:":"products added:":1===e?"produit ajouté :":"produits ajoutés :";u.textContent=t}}()}function p(){0===s.length&&o?o.style.display="none":o&&(o.style.display="block")}function f(){const e=Array.from(new Set(s.map((e=>e.category)))).join(", "),t=s.map((e=>`${e.quantity||1} ${e.name}`)).join(", ");c&&(c.value=e),i&&(i.value=t),r&&(r.value=e),a&&(a.value=t)}function q(e,t,n,o,r,a){let c,i=300;const u=()=>{let e=parseInt(n.textContent,10);"decrease"===t&&e>r?e--:"increase"===t&&e<a&&e++,n.textContent=e,function(e,t){const n=s.find((t=>t.id===e));n&&(n.quantity=t,m(),y(),f(),p())}(o,e)},l=()=>{u(),i=Math.max(i-30,30),c=setTimeout(l,i)},d=e=>{e.preventDefault(),i=300,u(),c=setTimeout(l,i)},q=()=>clearTimeout(c);e.addEventListener("mousedown",d),e.addEventListener("touchstart",d),document.addEventListener("mouseup",q),document.addEventListener("touchend",q),document.addEventListener("mouseleave",q)}!function e(){t&&n&&(t.innerHTML="",s.forEach((o=>{const r=n.content.cloneNode(!0),a=r.querySelector('[wl-card="image"]'),c=r.querySelector('[wl-card="category"]'),i=r.querySelector('[wl-card="name-link"]'),u=r.querySelector('[quantity="value"]'),l=r.querySelector('[wl-card="remove"]');if(!(a&&c&&i&&u&&l))return;a.src=o.image,a.alt=o.name,c.textContent=o.category,i.textContent=o.name,u.textContent=o.quantity||1,l.addEventListener("click",(()=>{s=s.filter((e=>e.id!==o.id)),m(),e(),y(),f(),p()}));const d=r.querySelector('[quantity="decrease"]'),g=r.querySelector('[quantity="increase"]'),S=u.closest('[quantity="input"]'),h=parseInt(S.dataset.min,10)||1,v=parseInt(S.dataset.max,10)||999;q(d,"decrease",u,o.id,h,v),q(g,"increase",u,o.id,h,v),t.appendChild(r)})))}(),y(),f(),p()}));
