document.addEventListener("DOMContentLoaded",(function(){const e="wishlist",t=document.querySelector('[wl-page="list"]'),n=document.querySelector("#wishlist-card-template"),o=document.querySelector('[form-element="wishlist"]'),a=document.querySelector('[wl-page="counter-label"]'),r=document.querySelector('[wl="counter"]'),c=(navigator.language||navigator.userLanguage).startsWith("en");let i;try{i=JSON.parse(localStorage.getItem(e))||[]}catch(e){i=[]}function u(){localStorage.setItem(e,JSON.stringify(i)),function(){const e=new CustomEvent("wishlist:updated",{detail:{wishlist:i}});document.dispatchEvent(e)}()}function l(){document.querySelectorAll('[wl="counter"]').forEach((e=>{e.textContent=i.length})),function(){const e=i.length;if(r&&a){const t=c?1===e?"product added:":"products added:":1===e?"produit ajouté :":"produits ajoutés :";a.textContent=t}}()}function d(){o&&(o.style.display=0===i.length?"none":"block")}function s(){const e=Array.from(new Set(i.map((e=>e.category)))).join(", "),t=i.map((e=>`${e.quantity||1} ${e.name}`)).join(", "),n=document.querySelectorAll('[wishlist-field="category"]'),o=document.querySelectorAll('[wishlist-field="product"]');n.forEach((t=>{t.value=e})),o.forEach((e=>{e.value=t}))}function m(e,t,n,o,a,r){let c,m=300;const y=()=>{let e=parseInt(n.textContent,10);"decrease"===t&&e>a?e--:"increase"===t&&e<r&&e++,n.textContent=e,function(e,t){const n=i.find((t=>t.id===e));n&&(n.quantity=t,u(),l(),s(),d())}(o,e)},f=()=>{y(),m=Math.max(m-30,30),c=setTimeout(f,m)},p=e=>{e.preventDefault(),m=300,y(),c=setTimeout(f,m)},q=()=>clearTimeout(c);e.addEventListener("mousedown",p),e.addEventListener("touchstart",p),document.addEventListener("mouseup",q),document.addEventListener("touchend",q),document.addEventListener("mouseleave",q)}!function e(){t&&n&&(t.innerHTML="",i.forEach((o=>{const a=n.content.cloneNode(!0),r=a.querySelector('[wl-card="image"]'),c=a.querySelector('[wl-card="category"]'),y=a.querySelector('[wl-card="name-link"]'),f=a.querySelector('[quantity="value"]'),p=a.querySelector('[wl-card="remove"]');if(!(r&&c&&y&&f&&p))return;r.src=o.image,r.alt=o.name,c.textContent=o.category,y.textContent=o.name,f.textContent=o.quantity||1,p.addEventListener("click",(()=>{i=i.filter((e=>e.id!==o.id)),u(),e(),l(),s(),d()}));const q=a.querySelector('[quantity="decrease"]'),g=a.querySelector('[quantity="increase"]'),h=f.closest('[quantity="input"]'),S=parseInt(h.dataset.min,10)||1,w=parseInt(h.dataset.max,10)||999;m(q,"decrease",f,o.id,S,w),m(g,"increase",f,o.id,S,w),t.appendChild(a)})))}(),l(),s(),d()}));
