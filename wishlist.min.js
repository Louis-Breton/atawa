document.addEventListener("DOMContentLoaded",(function(){const t="wishlist",e=document.querySelector('.drawer_body[wl="list"]'),n=document.querySelector('[wl="empty"]'),l=document.querySelector('[wl="cta"]'),o=document.querySelector('[wl="counter-label"]'),r=document.querySelector('[wl="counter-wrap"]'),i=document.querySelector('[fs-cmsload-element="list"]');let s=JSON.parse(localStorage.getItem(t)||"[]");function a(){try{localStorage.setItem(t,JSON.stringify(s))}catch(t){console.error("Erreur lors de l'accès au localStorage:",t)}}function c(){document.querySelectorAll('[wl="counter"]').forEach((t=>t.textContent=s.length)),function(){const t=(navigator.language||navigator.userLanguage).startsWith("fr"),e=s.length,n=t?e<=1?"produit ajouté :":"produits ajoutés :":e<=1?"product:":"products:";o&&(o.textContent=` ${n}`)}(),r&&(r.style.display=0===s.length?"none":"block")}function d(){0===s.length?(n.style.display="flex",l.style.display="none"):(n.style.display="none",l.style.display="block")}function u(){document.querySelectorAll('[wl="button"]').forEach((t=>{const e=t.getAttribute("wl-id"),n=s.some((t=>t.id===e));t.classList.toggle("is-active",n),t.setAttribute("data-tooltip",n?"Retirer de ma wishlist":"Ajouter à ma wishlist"),t.setAttribute("aria-pressed",n)}))}function m(){e.innerHTML="",s.forEach((t=>{const n=document.createElement("div");n.classList.add("wishlist_card"),n.setAttribute("wl-card","card");const l=document.createElement("div");l.classList.add("wishlist_card-image");const o=document.createElement("img");o.src=t.image,o.alt=t.name,o.classList.add("image-cover"),o.setAttribute("wl-card","image"),l.appendChild(o);const r=document.createElement("div");r.classList.add("wishlist_card-content");const i=document.createElement("p");i.classList.add("fs-9","text-neutral_400","text-style-ellipsis"),i.setAttribute("wl-card","category"),i.textContent=t.category;const d=document.createElement("a");d.href=t.link,d.classList.add("text-secondary_950-base","text-style-ellipsis"),d.setAttribute("wl-card","name-link"),d.textContent=t.name;const p=document.createElement("div");p.classList.add("wishlist_remove-product","w-embed"),p.setAttribute("wl-card","remove"),p.setAttribute("data-tooltip","Retirer de la wishlist"),p.innerHTML='\n                <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" role="img" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M5.5 5.5L12 12M12 12L18.5 18.5M12 12L5.5 18.5M12 12L18.5 5.5" \n                        stroke="currentColor" stroke-linecap="round" stroke-width="1.5" stroke-linejoin="round"></path>\n                </svg>\n            ',p.addEventListener("click",(()=>function(t){const e=s.findIndex((e=>e.id===t));e>-1&&(s.splice(e,1),a(),u(),m(),c())}(t.id))),r.appendChild(i),r.appendChild(d),r.appendChild(p),n.appendChild(l),n.appendChild(r),e.appendChild(n)})),d()}function p(){document.querySelectorAll('[wl="button"]').forEach((t=>{t.hasAttribute("data-wishlist-bound")||(t.setAttribute("data-wishlist-bound","true"),t.addEventListener("click",(()=>function(t){const e=t.closest('[wl="product"]'),n=t.getAttribute("wl-id"),l={id:n,name:e.querySelector('[wl="name"]').textContent,link:e.querySelector('[wl="link"]').getAttribute("href"),image:e.querySelector('[wl="image"]').getAttribute("src"),category:e.querySelector('[wl="category"]').textContent},o=s.findIndex((t=>t.id===n));o>-1?s.splice(o,1):s.push(l),a(),u(),d(),m(),c()}(t))))}))}p(),u(),d(),c(),m(),function(){if(!i)return;new MutationObserver((()=>{console.log("Nouveaux éléments détectés via lazy loading"),p(),u()})).observe(i,{childList:!0,subtree:!0})}()}));