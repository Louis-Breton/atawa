document.addEventListener("DOMContentLoaded",(function(){const t="wishlist",e=document.querySelector('.drawer_body[wl="list"]'),n=document.querySelector('[wl="empty"]'),o=document.querySelector('[wl="cta"]'),r=document.querySelector('[wl="counter-label"]'),l=document.querySelector('[wl="counter-wrap"]'),i=document.querySelector('[fs-cmsload-element="list"]');let a=JSON.parse(localStorage.getItem(t)||"[]");function s(){try{localStorage.setItem(t,JSON.stringify(a))}catch(t){console.error("Erreur lors de l'accès au localStorage:",t)}}function c(){document.querySelectorAll('[wl="counter"]').forEach((t=>t.textContent=a.length)),function(){const t=(navigator.language||navigator.userLanguage).startsWith("fr"),e=a.length,n=t?e<=1?"produit ajouté :":"produits ajoutés :":e<=1?"product:":"products:";r&&(r.textContent=` ${n}`)}(),l&&(l.style.display=0===a.length?"none":"block")}function d(){0===a.length?(n.style.display="flex",o.style.display="none"):(n.style.display="none",o.style.display="block")}function u(){const t=document.querySelectorAll('[wl="button"]'),e=(navigator.language||navigator.userLanguage).startsWith("fr"),n={add:e?"Ajouter à ma wishlist":"Add to my wishlist",remove:e?"Retirer de ma wishlist":"Remove from my wishlist"};t.forEach((t=>{const e=t.getAttribute("wl-id"),o=a.some((t=>t.id===e));t.classList.toggle("is-active",o),t.setAttribute("data-tooltip",o?n.remove:n.add),t.setAttribute("aria-pressed",o);const r=t.querySelector('[wl="label"]');r&&(r.textContent=o?n.remove:n.add)}))}function m(){e.innerHTML="",a.forEach((t=>{const n=document.createElement("div");n.classList.add("wishlist_card"),n.setAttribute("wl-card","card");const o=document.createElement("div");o.classList.add("wishlist_card-image");const r=document.createElement("img");r.src=t.image,r.alt=t.name,r.classList.add("image-cover"),r.setAttribute("wl-card","image"),o.appendChild(r);const l=document.createElement("div");l.classList.add("wishlist_card-content");const i=document.createElement("p");i.classList.add("fs-9","text-neutral_400"),i.setAttribute("wl-card","category"),i.textContent=t.category;const d=document.createElement("a");d.href=t.link,d.classList.add("text-style-underline"),d.setAttribute("wl-card","name-link"),d.textContent=t.name;const g=document.createElement("div");g.classList.add("wishlist_remove-product","w-embed"),g.setAttribute("wl-card","remove"),g.innerHTML='\n                <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" role="img" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M5.5 5.5L12 12M12 12L18.5 18.5M12 12L5.5 18.5M12 12L18.5 5.5" \n                        stroke="currentColor" stroke-linecap="round" stroke-width="1.5" stroke-linejoin="round"></path>\n                </svg>\n            ',g.addEventListener("click",(()=>function(t){const e=a.findIndex((e=>e.id===t));e>-1&&(a.splice(e,1),s(),u(),m(),c())}(t.id))),l.appendChild(i),l.appendChild(d),l.appendChild(g),n.appendChild(o),n.appendChild(l),e.appendChild(n)})),d()}function g(){document.querySelectorAll('[wl="button"]').forEach((t=>{t.hasAttribute("data-wishlist-bound")||(t.setAttribute("data-wishlist-bound","true"),t.addEventListener("click",(()=>function(t){const e=t.closest('[wl="product"]'),n=t.getAttribute("wl-id"),o={id:n,name:e.querySelector('[wl="name"]').textContent,link:e.querySelector('[wl="link"]').getAttribute("href"),image:e.querySelector('[wl="image"]').getAttribute("src"),category:e.querySelector('[wl="category"]').textContent},r=a.findIndex((t=>t.id===n));r>-1?a.splice(r,1):a.push(o),s(),u(),d(),m(),c()}(t))))}))}g(),u(),d(),c(),m(),function(){if(!i)return;new MutationObserver((()=>{console.log("Nouveaux éléments détectés via lazy loading"),g(),u()})).observe(i,{childList:!0,subtree:!0})}()}));