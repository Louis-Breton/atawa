document.addEventListener("DOMContentLoaded",(function(){const t="wishlist",e=document.querySelector('.drawer_body[wl="list"]'),n=document.querySelector('[wl="empty"]'),o=document.querySelector('[wl="cta"]'),l=document.querySelector('[wl="counter-label"]'),r=document.querySelector('[wl="counter-wrap"]'),s=document.querySelector('[fs-cmsload-element="list"]');let i=JSON.parse(localStorage.getItem(t)||"[]");function a(){try{localStorage.setItem(t,JSON.stringify(i))}catch(t){console.error("Erreur lors de l'accès au localStorage:",t)}}function c(){document.querySelectorAll('[wl="counter"]').forEach((t=>t.textContent=i.length)),function(){const t=(navigator.language||navigator.userLanguage).startsWith("fr"),e=i.length,n=t?e<=1?"produit ajouté :":"produits ajoutés :":e<=1?"product:":"products:";l&&(l.textContent=` ${n}`)}(),r&&(r.style.display=0===i.length?"none":"block")}function d(){0===i.length?(n.style.display="flex",o.style.display="none"):(n.style.display="none",o.style.display="block")}function u(){const t=document.querySelectorAll('[wl="button"]'),e=(navigator.language||navigator.userLanguage).startsWith("fr"),n={add:e?"Ajouter à ma wishlist":"Add to my wishlist",remove:e?"Retirer de ma wishlist":"Remove from my wishlist"};t.forEach((t=>{const e=t.getAttribute("wl-id"),o=i.some((t=>t.id===e));t.classList.toggle("is-active",o),t.setAttribute("data-tooltip",o?n.remove:n.add),t.setAttribute("aria-pressed",o);const l=t.querySelector('[wl="label"]');l&&(l.textContent=o?n.remove:n.add)}))}function m(){e.innerHTML="",i.forEach((t=>{const n=document.createElement("div");n.classList.add("wishlist_card"),n.setAttribute("wl-card","card");const o=document.createElement("div");o.classList.add("wishlist_card-image");const l=document.createElement("img");l.src=t.image,l.alt=t.name,l.classList.add("image-cover"),l.setAttribute("wl-card","image"),o.appendChild(l);const r=document.createElement("div");r.classList.add("wishlist_card-content");const s=document.createElement("p");s.classList.add("fs-9","text-neutral_400","text-style-ellipsis"),s.setAttribute("wl-card","category"),s.textContent=t.category;const d=document.createElement("a");d.href=t.link,d.classList.add("text-secondary_950-base","text-style-ellipsis"),d.setAttribute("wl-card","name-link"),d.textContent=t.name;const g=document.createElement("div");g.classList.add("wishlist_remove-product","w-embed"),g.setAttribute("wl-card","remove"),g.innerHTML='\n                <svg aria-hidden="true" viewBox="0 0 24 24" fill="none" role="img" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M5.5 5.5L12 12M12 12L18.5 18.5M12 12L5.5 18.5M12 12L18.5 5.5" \n                        stroke="currentColor" stroke-linecap="round" stroke-width="1.5" stroke-linejoin="round"></path>\n                </svg>\n            ',g.addEventListener("click",(()=>function(t){const e=i.findIndex((e=>e.id===t));e>-1&&(i.splice(e,1),a(),u(),m(),c())}(t.id))),r.appendChild(s),r.appendChild(d),r.appendChild(g),n.appendChild(o),n.appendChild(r),e.appendChild(n)})),d()}function g(){document.querySelectorAll('[wl="button"]').forEach((t=>{t.hasAttribute("data-wishlist-bound")||(t.setAttribute("data-wishlist-bound","true"),t.addEventListener("click",(()=>function(t){const e=t.closest('[wl="product"]'),n=t.getAttribute("wl-id"),o={id:n,name:e.querySelector('[wl="name"]').textContent,link:e.querySelector('[wl="link"]').getAttribute("href"),image:e.querySelector('[wl="image"]').getAttribute("src"),category:e.querySelector('[wl="category"]').textContent},l=i.findIndex((t=>t.id===n));l>-1?i.splice(l,1):i.push(o),a(),u(),d(),m(),c()}(t))))}))}g(),u(),d(),c(),m(),function(){if(!s)return;new MutationObserver((()=>{console.log("Nouveaux éléments détectés via lazy loading"),g(),u()})).observe(s,{childList:!0,subtree:!0})}()}));